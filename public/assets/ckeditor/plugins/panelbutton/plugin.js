/**
 * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
CKEDITOR.plugins.add("panelbutton",{requires:"button",onLoad:function(){function t(t){var e=this._;e.state!=CKEDITOR.TRISTATE_DISABLED&&(this.createPanel(t),e.on?e.panel.hide():e.panel.showBlock(this._.id,this.document.getById(this._.id),4))}CKEDITOR.ui.panelButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(e){var n=e.panel||{};delete e.panel,this.base(e),this.document=n.parent&&n.parent.getDocument()||CKEDITOR.document,n.block={attributes:n.attributes},n.toolbarRelated=!0,this.hasArrow="listbox",this.click=t,this._={panelDefinition:n}},statics:{handler:{create:function(t){return new CKEDITOR.ui.panelButton(t)}}},proto:{createPanel:function(t){var e=this._;if(!e.panel){var n=this._.panelDefinition,o=this._.panelDefinition.block,a=n.parent||CKEDITOR.document.getBody(),s=this._.panel=new CKEDITOR.ui.floatPanel(t,a,n),i=s.addBlock(e.id,o),l=this,d=t.getCommand(this.command);s.onShow=function(){l.className&&this.element.addClass(l.className+"_panel"),l.setState(CKEDITOR.TRISTATE_ON),e.on=1,l.editorFocus&&t.focus(),l.onOpen&&l.onOpen()},s.onHide=function(n){l.className&&this.element.getFirst().removeClass(l.className+"_panel"),!l.modes&&d?l.setStateFromCommand(d):l.setState(l.modes&&l.modes[t.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),e.on=0,!n&&l.onClose&&l.onClose()},s.onEscape=function(){s.hide(1),l.document.getById(e.id).focus()},this.onBlock&&this.onBlock(s,i),i.onHide=function(){e.on=0,!l.modes&&l.command?l.setStateFromCommand(d):l.setState(CKEDITOR.TRISTATE_OFF)}}},setStateFromCommand:function(t){this.setState(t.state)}}})},beforeInit:function(t){t.ui.addHandler(CKEDITOR.UI_PANELBUTTON,CKEDITOR.ui.panelButton.handler)}}),CKEDITOR.UI_PANELBUTTON="panelbutton";