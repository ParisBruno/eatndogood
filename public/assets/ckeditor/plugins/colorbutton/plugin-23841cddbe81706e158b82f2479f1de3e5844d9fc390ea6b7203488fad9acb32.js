CKEDITOR.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",lang:"af,ar,az,bg,bn,bs,ca,cs,cy,da,de,de-ch,el,en,en-au,en-ca,en-gb,eo,es,es-mx,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,oc,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",icons:"bgcolor,textcolor",hidpi:!0,init:function(k){function t(t){var i,e=t.name,u=t.type,o=t.title,r=t.order,n=t.commandName,a=t.contentTransformations||{},l=new CKEDITOR.style(E["colorButton_"+u+"Style"]),d=CKEDITOR.tools.getNextId()+"_colorBox",f={type:u},c=new CKEDITOR.style(E["colorButton_"+u+"Style"],{color:"inherit"});k.addCommand(n,{contextSensitive:!0,exec:function(t,e){if(!t.readOnly){var o=e.newStyle;t.removeStyle(c),t.focus(),o&&t.applyStyle(o),t.fire("saveSnapshot")}},refresh:function(t,e){c.checkApplicable(e,t,t.activeFilter)?c.checkActive(e,t)?this.setState(CKEDITOR.TRISTATE_ON):this.setState(CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)}}),k.ui.add(e,CKEDITOR.UI_PANELBUTTON,{label:o,title:o,command:n,editorFocus:0,toolbar:"colors,"+r,allowedContent:l,requiredContent:l,contentTransformations:a,panel:{css:CKEDITOR.skin.getPath("editor"),attributes:{role:"listbox","aria-label":h.panelTitle}},select:function(t){var e=E.colorButton_colors.split(","),o=CKEDITOR.tools.array.find(e,t);o=p(o),g(i,o),i._.markFirstDisplayed()},onBlock:function(t,e){(i=e).autoSize=!0,e.element.addClass("cke_colorblock"),e.element.setHtml(s({type:u,colorBoxId:d,colorData:f,commandName:n})),e.element.getDocument().getBody().setStyle("overflow","hidden"),CKEDITOR.ui.fire("ready",this);var o=e.keys,r="rtl"==k.lang.dir;o[r?37:39]="next",o[40]="next",o[9]="next",o[r?39:37]="prev",o[38]="prev",o[CKEDITOR.SHIFT+9]="prev",o[32]="click"},onOpen:function(){var t,e=k.getSelection(),o=e&&e.getStartElement(),r=k.elementPath(o);if(!r)return null;for(o=r.block||r.blockLimit||k.document.getBody();t=o&&o.getComputedStyle("back"==u?"background-color":"color")||"transparent","back"==u&&"transparent"==t&&o&&(o=o.getParent()););t&&"transparent"!=t||(t="#ffffff"),!1!==E.colorButton_enableAutomatic&&this._.panel._.iframe.getFrameDocument().getById(d).setStyle("background-color",t);var n=e&&e.getRanges()[0];if(n){for(var a,l=new CKEDITOR.dom.walker(n),c=n.collapsed?n.startContainer:l.next(),s="";c;){if(c.type!==CKEDITOR.NODE_ELEMENT&&(c=c.getParent()),a=p(c.getComputedStyle("back"==u?"background-color":"color")),(s=s||a)!==a){s="";break}c=l.next()}"transparent"==s&&(s=""),"fore"==u&&(f.automaticTextColor="#"+p(t)),f.selectionColor=s?"#"+s:"",g(i,s)}return t}})}function s(t){function e(t){var e=t&&new CKEDITOR.style(d,{color:t});k.execCommand(a,{newStyle:e})}var o=t.type,r=t.colorBoxId,n=t.colorData,a=t.commandName,l=[],c=E.colorButton_colors.split(","),s=E.colorButton_colorsPerRow||6,i=k.plugins.colordialog&&!1!==E.colorButton_enableMore,u=c.length+(i?2:1),d=k.config["colorButton_"+o+"Style"];d.childRule="back"==o?function(t){return y(t)}:function(t){return!(t.is("a")||t.getElementsByTag("a").count())||y(t)};var f=CKEDITOR.tools.addFunction(function T(t){k.focus(),k.fire("saveSnapshot"),"?"==t?k.getColorFromDialog(function(t){t&&e(t)},null,n):e(t&&"#"+t)});!1!==E.colorButton_enableAutomatic&&l.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true title="',h.auto,'" draggable="false" ondragstart="return false;" onclick="CKEDITOR.tools.callFunction(',f,",null,'",o,"');return false;\" href=\"javascript:void('",h.auto,'\')" role="option" aria-posinset="1" aria-setsize="',u,'"><table role="presentation" cellspacing=0 cellpadding=0 width="100%"><tr><td colspan="'+s+'" align="center"><span class="cke_colorbox" id="',r,'"></span>',h.auto,"</td></tr></table></a>"),l.push('<table role="presentation" cellspacing=0 cellpadding=0 width="100%">');for(var g=0;g<c.length;g++){g%s==0&&l.push("</tr><tr>");var p,m=c[g].split("/"),b=m[0],C=m[1]||b;p=m[1]?b:k.lang.colorbutton.colors[C]||C,l.push('<td><a class="cke_colorbox" _cke_focus=1 hidefocus=true title="',p,'" draggable="false" ondragstart="return false;" onclick="CKEDITOR.tools.callFunction(',f,",'",C,"','",o,"'); return false;\" href=\"javascript:void('",C,'\')" data-value="'+C+'" role="option" aria-posinset="',g+2,'" aria-setsize="',u,'"><span class="cke_colorbox" style="background-color:#',C,'"></span></a></td>')}return i&&l.push('</tr><tr><td colspan="'+s+'" align="center"><a class="cke_colormore" _cke_focus=1 hidefocus=true title="',h.more,'" draggable="false" ondragstart="return false;" onclick="CKEDITOR.tools.callFunction(',f,",'?','",o,"');return false;\" href=\"javascript:void('",h.more,"')\"",' role="option" aria-posinset="',u,'" aria-setsize="',u,'">',h.more,"</a></td>"),l.push("</tr></table>"),l.join("")}function y(t){return"false"==t.getAttribute("contentEditable")||t.getAttribute("data-nostyle")}function g(t,e){for(var o=t._.getItems(),r=0;r<o.count();r++){var n=o.getItem(r);n.removeAttribute("aria-selected"),e&&e==p(n.getAttribute("data-value"))&&n.setAttribute("aria-selected",!0)}}function p(t){return CKEDITOR.tools.normalizeHex("#"+CKEDITOR.tools.convertRgbToHex(t||"")).replace(/#/g,"")}var E=k.config,h=k.lang.colorbutton;if(!CKEDITOR.env.hc){t({name:"TextColor",type:"fore",commandName:"textColor",title:h.textColorTitle,order:10,contentTransformations:[[{element:"font",check:"span{color}",left:function(t){return!!t.attributes.color},right:function(t){t.name="span",t.attributes.color&&(t.styles.color=t.attributes.color),delete t.attributes.color}}]]});var e,o=k.config.colorButton_normalizeBackground;(o===undefined||o)&&(e=[[{element:"span",left:function(t){var e=CKEDITOR.tools;if("span"!=t.name||!t.styles||!t.styles.background)return!1;var o=e.style.parse.background(t.styles.background);return o.color&&1===e.object.keys(o).length},right:function(t){var e=new CKEDITOR.style(k.config.colorButton_backStyle,{color:t.styles.background}).getDefinition();return t.name=e.element,t.styles=e.styles,t.attributes=e.attributes||{},t}}]]),t({name:"BGColor",type:"back",commandName:"bgColor",title:h.bgColorTitle,order:20,contentTransformations:e})}}}),CKEDITOR.config.colorButton_colors="1ABC9C,2ECC71,3498DB,9B59B6,4E5F70,F1C40F,16A085,27AE60,2980B9,8E44AD,2C3E50,F39C12,E67E22,E74C3C,ECF0F1,95A5A6,DDD,FFF,D35400,C0392B,BDC3C7,7F8C8D,999,000",CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]},CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};