<%= form_for(@page, html: { multipart: true }) do |f| %>
    <%= f.hidden_field :destination %>
      
        <div class="col-md-6  well box-content">
          <label><%= t('pages.new.edit_page_text') %></label>
          
          <%= cktext_area :page, :title, value: (@page.present?) ? @page.title :  'A Taste of', required: true  %>
          
          <span style="color:red;display:none;" id="span_err_1"><%= t('pages.new.you_can_not_write_more_chars', max: 40) %></span><br>
          <label><%= t('pages.new.edit_app_name') %></label>
          <%= cktext_area(:page, :content, value: (@page.present?) ? @page.content : 'iTopRecipes!', cols: 4, rows: 4, class: 'classy-editor2', required: true) %>
          <span style="color:red;display:none;" id="span_err_2"><%= t('pages.new.you_can_not_write_more_chars', max: 30) %></span><br>
        </div>
        <div class="col-md-1"> </div>
        <div class="col-md-5  well box-content">
          <span class="picture">
            <%= image_tag( (!@page.nil? && @page.page_img.url.present?) ? @page.page_img.url : 'cooking-new.png', class: 'img-responsive', alt: t('common.no_image'), style: 'width: 20% !important') %>
            <label><%= t('pages.new.upload_landing_pic_max_size', max: 5) %></label>
            <%= f.file_field :page_img, accept: 'image/jpeg,image/gif,image/png' %>
          </span>
          <div>
            <center>
              <%= f.submit t('pages.new.tap_or_click_to_save'), class: "btn btn-success btn-lg", id: "submit_btn" %>
            </center>
            
          </div>
          

          <div class="">
            <a target="_blank" href="<%= welcome_pages_path(:username=> current_user.full_name,:admin_id => current_user.id) %>" style="float: right;margin-top: -30px; color:white;" class="btn btn-success btn-lg">
              <%= t('pages.new.save_to_view_changes') %>
            </a>
          </div>
        </div>
      
  <% end %>


  <script type="text/javascript">
    

    $(document).ready(function() {
         var _URL = window.URL || window.webkitURL;

          $("#page_welcomepic").change(function (e) {

             //alert('yes');
              size_in_megabytes = this.files[0].size/2048/2048;
              //alert(size_in_megabytes);
              if (size_in_megabytes > 1) {
                alert('<%= t('errors.max_file_size', max: 5) %>')
                $("#submit_btn").attr("type", "button");
                return false;
              }

              var file, img;
              if ((file = this.files[0])) {
                  img = new Image();
                  img.onload = function () {

                      if(this.width < 500 && this.height < 600) {
                        //alert(this.width + " " + this.height);
                        alert('<%= t('errors.image_atleas_dimensions', dims: '500*600') %>');
                        $("#submit_btn").attr("type", "button");
                        return false;
                      }
                  };
                  img.src = _URL.createObjectURL(file);

              }

             $("#submit_btn").attr("type", "submit");

          });

          var max = 40;
          $('#page_pages_text').change(function(e) {
              //console.log('in');
              if (e.which < 0x20) {
                  // e.which < 0x20, then it's not a printable character
                  // e.which === 0 - Not a character
                  return;     // Do nothing
              }
              if (this.value.length == max) {
                 $("#span_err_1").show().delay(3000).fadeOut();;
                  e.preventDefault();
              } else if (this.value.length > max) {
                  // Maximum exceeded

                  this.value = this.value.substring(0, max);
                  $("#span_err_1").show().delay(3000).fadeOut();;
              }
          });

          var max_name = 30;
          $('#page_pages_name').change(function(e) {
              //console.log('in');
              if (e.which < 0x20) {
                  // e.which < 0x20, then it's not a printable character
                  // e.which === 0 - Not a character
                  return;     // Do nothing
              }
              if (this.value.length == max_name) {
                 $("#span_err_2").show().delay(3000).fadeOut();;
                  e.preventDefault();
              } else if (this.value.length > max_name) {
                  // Maximum exceeded

                  this.value = this.value.substring(0, max_name);
                  $("#span_err_2").show().delay(3000).fadeOut();;
              }
          });




        //jquery editor setting
        //$(".classy-editor").ClassyEdit();
        //$(".classy-editor2").ClassyEdit();

    });


    </script>